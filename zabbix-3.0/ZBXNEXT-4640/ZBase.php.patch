116a117,125
> 	 * Initializes the application for Keycloak plugins.
>      */
>     public function run4kc (){
>         $this->init();
>         $this->loadConfigFile();
>         $this->initDB();
>     }
> 
> 	/**
355,365c364,371
< 		$sessionId = CWebUser::checkAuthentication(CWebUser::getSessionCookie());
< 
< 		if (!$sessionId) {
< 			CWebUser::setDefault();
< 		}
< 
< 		// set the authentication token for the API
< 		API::getWrapper()->auth = $sessionId;
< 
< 		// enable debug mode in the API
< 		API::getWrapper()->debug = CWebUser::getDebugMode();
---
>         $sessionId = CWebUser::checkAuthentication(CWebUser::getSessionCookie());
>         if (!$sessionId) {
>             CWebUser::setDefault();
>         }
>         // set the authentication token for the API
>         API::getWrapper()->auth = $sessionId;
>         // enable debug mode in the API
>         API::getWrapper()->debug = CWebUser::getDebugMode();
376c382
< 		$controller = new $controller();
---
>         $controller = new $controller();
378,379c384
< 		$response = $controller->run();
< 
---
>         $response = $controller->run();
381c386
< 		if ($response instanceof CControllerResponseData) {
---
>         if ($response instanceof CControllerResponseData) {
